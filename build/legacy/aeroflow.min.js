!function(n,t){if("function"==typeof define&&define.amd)define(["exports"],t);else if("undefined"!=typeof exports)t(exports);else{var u={exports:{}};t(u.exports),n.aeroflow=u.exports}}(this,function(n){"use strict";function t(n,t,u){return t in n?Object.defineProperty(n,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):n[t]=u,n}function u(){for(var n=arguments.length,t=Array(n),u=0;n>u;u++)t[u]=arguments[u];return O.apply(void 0,[this].concat(t))}function r(n,t){switch(arguments.length){case 0:return nt;case 1:return V(n)?new S(an(this[R],n)):_(n);default:return V(n)?new S(cn(this[R],n,t)):_(n)}}function e(){return new S(ln(this[R]))}function i(n){return new S(V(n)?dn(this[R],n):U(n)?dn(this[R],function(){return rn(n-new Date,0)}):hn(this[R],rn(+n||0,0)))}function o(n,t){return new S(0===arguments.length?mn(this[R],""):1===arguments.length?V(n)?wn(this[R],"",n):mn(this[R],""):V(t)?Y(n)?wn(this[R],"",t):wn(this[R],n,t):mn(this[R],n))}function f(n){return new S(gn(this[R],Y(n)?function(n){return!!n}:V(n)?n:$(n)?function(t){return n.test(t)}:function(t){return t===n}))}function c(n){return new S(Mn(this[R],Y(n)?function(n){return!!n}:V(n)?n:$(n)?function(t){return n.test(t)}:function(t){return t===n}))}function a(n){return new S(Pn(this[R],arguments.length?V(n)?n:function(){return""+n}:function(){return","}))}function s(n){return arguments.length?new S(Sn(this[R],V(n)?n:K(n))):this}function l(){return new S(jn(this[R]))}function v(){return new S(On(this[R]))}function h(){for(var n=arguments.length,t=Array(n),u=0;n>u;u++)t[u]=arguments[u];return O.apply(void 0,t.concat([this]))}function d(n,t){var u=!0,r=[],e=function(){return u},i=function(){return u&&(u=!1,r.forEach(function(n){return n()})),!1},o=function(n){return V(n)&&(u?r.push(n):n()),n},f=function(){return o(d(n,t).end)};return on(e,{data:{value:t},flow:{value:n},end:{value:i},onend:{value:o},spawn:{value:f}})}function m(n,t,u){V(t)||(t=en),V(n)||(n=en);var r=d(this,u),e=this[R];return setImmediate(function(){var u=0;e(function(t){return n(t,u++,r)},function(n){r.end(),t(n,u,r)},r)}),this}function w(n){return new S(arguments.length?V(n)?In(this[R],n):In(this[R],K(n)):Fn(this[R]))}function g(n){return arguments.length?Z(n)?0===n?this:new S(n>0?Rn(this[R],n):Gn(this[R],-n)):V(n)?new S(Xn(this[R],n)):n?new S(kn(this[R])):this:new S(kn(this[R]))}function p(n){return new S(qn(this[R],arguments.length?V(n)?n:$(n)?function(t){return n.test(t)}:function(t){return t===n}:function(n){return!!n}))}function y(){return new S(zn(this[R]))}function b(n){return arguments.length?Z(n)?0===n?nt:new S(n>0?Bn(this[R],n):Cn(this[R],n)):V(n)?new S(Hn(this[R],n)):n?this:nt:this}function x(n){return V(n)?new S(Jn(this[R],n)):this}function A(){return new S(Kn(this[R]))}function M(n,t){return new S(0===arguments.length?Ln(this[R]):Qn(this[R],V(n)?n:K(n),1===arguments.length?Q:V(t)?n:K(t)))}function P(n){return new S(0===arguments.length?Un(this[R]):Vn(this[R],V(n)?n:K(n)))}function S(n){fn(this,R,{value:n})}function j(){for(var n=arguments.length,t=Array(n),u=0;n>u;u++)t[u]=arguments[u];switch(t.length){case 0:return $n();case 1:var r=Wn[classOf(e)],e=t[0];return isFunction(r)?r(e):isObject(e)&&X in e?function(n){return function(t,u,r){for(var e=n[X](),i=void 0;r()&&!(i=e.next()).done;)t(i.value);u()}}:N(e);default:return function(n,u,r){var e=-1,i=t.length,o=function f(){++e<i?j(t[e])(n,f,r):u()};o()}}}function O(){return new S(j.apply(void 0,arguments))}Object.defineProperty(n,"__esModule",{value:!0});var E,T=arguments,N=function(n){return function(t,u){var r=t(n);return u(),r}},_=function(n){return new S(N(n))},D="Aeroflow",F="Array",I=Symbol.toStringTag,k="Date",R=Symbol("emitter"),G="Function",X=Symbol.iterator,q="Number",z="Promise",B="prototype",C="RegExp",H=function(n){return Object.prototype.toString.call(n).slice(8,-1)},J=function(n){return function(t){return H(t)===n}},K=function(n){return function(){return n}},L=Date.now,Q=function(n){return n},U=J(k),V=J(G),W=Number.isInteger,Y=function(n){return null==n},Z=J(q),$=J(C),nn=Math.floor,tn=Math.random,un=Number.MAX_SAFE_INTEGER,rn=Math.max,en=function(){},on=Object.defineProperties,fn=Object.defineProperty,cn=function(n,t,u){return function(r,e,i){var o=0,f=u;n(function(n){return f=t(f,n,o++,i.data)},function(n){r(f),e(n)},i)}},an=function(n,t){return function(u,r,e){var i=!0,o=1,f=void 0;n(function(n){i?(i=!1,f=n):f=t(f,n,o++,e.data)},function(n){i||u(f),r(n)},e)}},sn=function(n,t,u){return function(r,e,i){var o=!0,f=0,c=u;n(function(n){o=!1,c=t(c,n,f++,i.data)},function(n){o||r(c),e(n)},i)}},ln=function(n){return cn(n,function(n){return n+1},0)},vn=function(n){return T.length?V(n)?new S(function(t,u,r){var e=!1;r.onend(n(function(n){return r()?t():!1},function(n){e||(e=!0,u(),r.end())},r))}):_(n):nt},hn=function(n,t){return function(u,r,e){return n(function(n){return new Promise(function(r){return setTimeout(function(){return r(u(n))},t)})},function(n){return new Promise(function(u){return setTimeout(function(){return u(r(n))},t)})},e)}},dn=function(n,t){return function(u,r,e){var i=L(),o=0;n(function(n){var r=t(n,o++,e.data),f=void 0;return U(r)?(f=r,r-=L()):f=L()+r,f>i&&(i=f),new Promise(function(t){return setTimeout(function(){return t(u(n))},rn(r,0))})},function(n){return i-=L(),new Promise(function(t){return setTimeout(function(){return t(r(n))},rn(i,0))})},e)}},mn=function(n,t){return function(u,r,e){return n(function(n){console.log(t+"next",n),u(n)},function(n){n?console.error(t+"done",n):console.log(t+"done"),r(n)},e)}},wn=function(n,t,u){return function(r,e,i){return n(function(n){u(t+"next",n),r(n)},function(n){n?u(t+"done",n):u(t+"done"),e(n)},i)}},gn=function(n,t){return function(u,r,e){var i=!0,o=!0;e=e.spawn(),n(function(n){i=!1,t(n)&&(o=!1,e.end())},function(n){u(o&&!i),r(n)},e)}},pn=function(n){return function(t,u,r){for(;r();)t(n);u()}},yn=function(n){return function(t,u,r){for(var e=0,i=void 0;r()&&!1!==(i=n(e++,r.data));)t(i);u()}},bn=function(n){return new S(V(n)?yn(n):pn(n))},xn=function(n,t){return function(u,r,e){for(var i=0,o=t;e();)u(o=n(o,i++,e.data));r()}},An=function(n,t){return V(n)?new S(xn(n,t)):pn(n)},Mn=function(n,t){return function(u,r,e){var i=0;n(function(n){return t(n,i++,e.data)?u(n):!0},r,e)}},Pn=function(n,t){return sn(n,function(n,u,r,e){return n.length?n+t(u,r,e)+u:u},"")},Sn=function(n,t){return function(u,r,e){var i=0;n(function(n){return u(t(n,i++,e.data))},r,e)}},jn=function(n){return an(n,function(n,t){return t>n?t:n})},On=function(n){return an(n,function(n,t){return n>t?t:n})},En=function(n,t){return function(u,r,e){for(;e();)u(n+t*tn());r()}},Tn=function(n,t){return function(u,r,e){for(;e();)u(nn(n+t*tn()));r()}},Nn=function(n,t){return n=+n||0,t=+t||1,t-=n,new S(W(n)&&W(t)?Tn(n,t):En(n,t))},_n=function(n,t,u){return function(r,e,i){var o=n-u;if(t>n)for(;i()&&(o+=u)<=t;)r(o);else for(;i()&&(o+=u)>=t;)r(o);e()}},Dn=function(n,t,u){return t=+t||un,n=+n||0,u=+u||(t>n?1:-1),n===t?_(n):new S(_n(n,t,u))},Fn=function(n){return function(t,u,r){var e=[];n(function(n){return e.push(n)},function(n){t(e),u(n)},r)}},In=function(n,t){return function(u,r,e){var i=0,o=[];n(function(n){return o.push(t(n,i++,e.data))},function(n){u(o),r(n)},e)}},kn=function(n){return function(t,u,r){return n(en,u,r)}},Rn=function(n,t){return function(u,r,e){var i=-1;n(function(n){return++i<t?!1:u(n)},r,e)}},Gn=function(n,t){return function(u,r,e){return Fn(n)(function(n){for(var r=-1,e=n.length-t;++r<e;)u(n[r])},r,e)}},Xn=function(n,t){return function(u,r,e){var i=0,o=!0;n(function(n){o&&!t(n,i++,e.data)&&(o=!1),o||u(n)},r,e)}},qn=function(n,t){return function(u,r,e){var i=!1;e=e.spawn(),n(function(n){t(n)&&(i=!0,e.end())},function(n){u(i),r(n)},e)}},zn=function(n){return cn(n,function(n,t){return n+t},0)},Bn=function(n,t){return function(u,r,e){var i=1;e=e.spawn(),n(function(n){u(n),t<=i++&&e.end()},r,e)}},Cn=function(n,t){return function(u,r,e){return Fn(n)(function(n){for(var r=n.length,e=rn(r-1-t,0);r>e;)u(n[e++])},r,e)}},Hn=function(n,t){return function(u,r,e){var i=0;e=e.spawn(),n(function(n){return t(n,i++,e.data)?u(n):e.end()},r,e)}},Jn=function(n,t){return function(u,r,e){var i=0;n(function(n){return t(n,i++,e.data),u(n)},r,e)}},Kn=function(n){return function(t,u,r){var e=L();n(function(n){var u=L();t({timedelta:u-e,timestamp:L,value:n}),e=u},u,r)}},Ln=function(n){return function(t,u,r){var e=new Map;n(function(n){return e.set(n,n)},function(n){t(e),u(n)},r)}},Qn=function(n,t,u){return function(r,e,i){var o=0,f=new Map;n(function(n){return f.set(t(n,o++,i.data),u(n,o++,i.data))},function(n){r(f),e(n)},i)}},Un=function(n){return function(t,u,r){var e=new Set;n(function(n){return e.add(n)},function(n){t(e),u(n)},r)}},Vn=function(n,t){return function(u,r,e){var i=0,o=new Set;n(function(n){return o.add(t(n,i++,e.data))},function(n){u(o),r(n)},e)}};on(S[B],(E={},t(E,I,{value:D}),t(E,"append",{value:u}),t(E,"count",{value:e}),t(E,"delay",{value:i}),t(E,"dump",{value:o}),t(E,"emitters",{value:Wn}),t(E,"every",{value:f}),t(E,"filter",{value:c}),t(E,"join",{value:a}),t(E,"map",{value:s}),t(E,"max",{value:l}),t(E,"min",{value:v}),t(E,"prepend",{value:h}),t(E,"reduce",{value:r}),t(E,"run",{value:m}),t(E,"skip",{value:g}),t(E,"some",{value:p}),t(E,"sum",{value:y}),t(E,"take",{value:b}),t(E,"tap",{value:x}),t(E,"timestamp",{value:A}),t(E,"toArray",{value:w}),t(E,"toMap",{value:M}),t(E,"toSet",{value:P}),E));var Wn=new Map,Yn=function(n){return n[R]},Zn=function(n){return function(t,u,r){for(var e=-1;r()&&++e<n.length;)t(n[e]);u()}},$n=function(){return function(n,t){return t()}},nt=new S($n()),tt=function(n){return function(t,u,r){j(n(r.data))(t,u,r)}},ut=function(n){return function(t,u,r){n.then(function(n){return j(n)(t,u,r)},function(n){u(n),throwError(n)})}};Wn.set(D,Yn),Wn.set(F,Zn),Wn.set(G,tt),Wn.set(z,ut),on(O,{create:{value:vn},empty:{value:nt},expand:{value:An},just:{value:_},random:{value:Nn},range:{value:Dn},repeat:{value:bn}}),n.Aeroflow=S,n.aeroflow=O,n.empty=nt});