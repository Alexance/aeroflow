!function(n,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var r={exports:{}};t(r,r.exports),n.aeroflow=r.exports}}(this,function(n,t){"use strict";function r(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function u(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function e(n){return function(t,r,u){for(var e=-1;u.active&&++e<n.length;)t(n[e]);r()}}function i(){return function(n,t){return t()}}function o(n){return function(t,r,u){t(n(u.data)),r()}}function c(n){return function(t,r,u){return n.then(function(n){return t(n)},function(n){return r(n)})}}function a(n){return function(t,r){t(n),r()}}function f(n){return arguments.length?nt(n)?function(t,r,u){return u.track(n(function(n){u.active&&t()},function(n){u.active&&(r(),u.done())},u))}:a(n):i()}function l(n,t){var r=nt(n)?n:Xn(n);return function(n,u,e){for(var i=0,o=t;e.active;)n(o=r(o,i++,e.data));u()}}function v(n,t){return function(r,u,e){for(;e.active;)r(n+t*ot());u()}}function s(n,t){return function(r,u,e){for(;e.active;)r(it(n+t*ot()));u()}}function h(n,t){return n=+n||0,t=+t||1,t-=n,tt(n)&&tt(t)?s(n,t):v(n,t)}function d(n,t,r){return function(u,e,i){var o=n-r;if(t>n)for(;i.active&&(o+=r)<=t;)u(o);else for(;i.active&&(o+=r)>=t;)u(o);e()}}function w(n){return function(t,r,u){for(var e=0,i=void 0;u.active&&!1!==(i=n(e++,u.data));)t(i);r()}}function m(n){return function(t,r,u){for(;u.active;)t(n);r()}}function b(n){return isFunction(n)?w(n):m(n)}function p(n){return function(t){return function(r,u,e){var i=!0,o=1,c=void 0;t(function(t){i?(i=!1,c=t):c=n(c,t,o++,e.data)},function(n){i||r(c),u(n)},e)}}}function g(n,t){return function(r){return function(u,e,i){var o=0,c=t;r(function(t){return c=n(c,t,o++,i.data)},function(n){u(c),e(n)},i)}}}function y(n,t){return function(r){return function(u,e,i){var o=!0,c=0,a=t;r(function(t){o=!1,a=n(a,t,c++,i.data)},function(n){o||u(a),e(n)},i)}}}function x(n,t,r){var u=arguments.length;if(!u||!nt(n))return function(){return i()};switch(u){case 1:return p(n);case 2:return g(n,t);default:return nt(n)?r?y(n,t):g(n,t):function(){return a(n)}}}function k(n){return(n?y:g)(function(n){return n+1},0)}function j(n){return function(t){return function(r,u,e){var i=Yn(),o=0;t(function(t){var u=n(t,o++,e.data),c=void 0;$n(u)?(c=u,u-=Yn()):c=Yn()+u,c>i&&(i=c),setTimeout(function(){return resolve(r(t))},ct(u,0))},function(n){i-=Yn(),setTimeout(function(){return resolve(u(n))},ct(i,0))},e)}}}function S(n){return function(t){return function(r,u,e){return t(function(t){return setTimeout(function(){return r(t)},n)},function(t){return setTimeout(function(){return u(t)},n)},e)}}}function A(n){return nt(n)?j(n):$n(n)?j(function(){return ct(n-new Date,0)}):S(ct(+n||0,0))}function O(n){return function(t){return function(r,u,e){return t(function(t){console.log(n+"next",t),r(t)},function(t){t?console.error(n+"done",t):console.log(n+"done"),u(t)},e)}}}function M(n,t){return function(r){return function(u,e,i){return r(function(r){t(n+"next",r),u(r)},function(r){r?t(n+"done",r):t(n+"done"),e(r)},i)}}}function P(n,t){return nt(n)?M("",n):nt(t)?M(n,t):O(rt(n)?"":n)}function T(n){var t=nt(n)?n:et(n)?function(t){return n.test(t)}:function(t){return t===n};return function(n){return function(r,u,e){var i=!0,o=!0;e=e.spawn(),n(function(n){i=!1,t(n)&&(o=!1,e.done())},function(n){r(o&&!i),u(n)},e)}}}function N(n){var t=nt(n)?n:et(n)?function(t){return n.test(t)}:rt(n)?function(n){return!!n}:function(t){return t===n};return function(n){return function(r,u,e){var i=0;n(function(n){t(n,i++,e.data)&&r(n)},u,e)}}}function D(n,t){var r=nt(n)?n:rt(n)?function(){return","}:function(){return n};return(t?y:g)(function(n,t,u,e){return n.length?n+r(t,u,e)+t:t},"")}function E(n){if(rt(n))return Zn;var t=nt(n)?n:Xn(n);return function(n){return function(r,u,e){var i=0;n(function(n){return r(t(n,i++,e.data))},u,e)}}}function F(){return p(function(n,t){return t>n?t:n})}function I(){return function(n){return function(t,r,u){var e=[];n(function(n){return e.push(n)},function(n){t(e),r(n)},u)}}}function _(){return function(n){return function(t,r,u){return I()(n)(function(n){n.length&&(n.sort(),t(n[it(n.length/2)]))},r,u)}}}function B(){return p(function(n,t){return n>t?t:n})}function C(){return function(n){return function(t,r,u){return n(at,r,u)}}}function R(n){return function(t){return function(r,u,e){var i=-1;t(function(t){++i>=n&&r(t)},u,e)}}}function q(n){return function(t){return function(r,u,e){return I()(t)(function(t){for(var u=-1,e=t.length-n;++u<e;)r(t[u])},u,e)}}}function z(n){return function(t){return function(r,u,e){var i=0,o=!0;t(function(t){o&&!n(t,i++,e.data)&&(o=!1),o||r(t)},u,e)}}}function G(n){return arguments.length?ut(n)?0===n?identity:n>0?R(n):q(-n):nt(n)?z(n):n?C():identity:C()}function H(n){var t=nt(n)?n:et(n)?function(t){return n.test(t)}:function(t){return t===n};return function(n){return function(r,u,e){var i=!1;e=e.spawn(),n(function(n){t(n)&&(i=!0,e.done())},function(n){r(i),u(n)},e)}}}function J(){return function(n){return g(function(n,t){return n+t},0)}}function K(n){return function(t){return function(r,u,e){var i=1;e=e.spawn(),t(function(t){r(t),n<=i++&&e.done()},u,e)}}}function L(n){return function(t){return function(r,u,e){return I()(t)(function(t){for(var u=t.length,e=ct(u-1-n,0);u>e;)r(t[e++])},u,e)}}}function Q(n){return function(t){return function(r,u,e){var i=0;e=e.spawn(),t(function(t){n(t,i++,e.data)?r(t):e.done()},u,e)}}}function U(n){return arguments.length?ut(n)?0===n?i():n>0?K(n):L(n):nt(n)?Q(n):n?Zn:i():Zn}function V(n){return function(t){return nt(n)?function(r,u,e){var i=0;t(function(t){return n(t,i++,e.data),r(t)},u,e)}:t}}function W(){return function(n){return function(t,r,u){var e=Yn();n(function(n){var r=Yn();t({timedelta:r-e,timestamp:Yn,value:n}),e=r},r,u)}}}function X(n,t){var r=isNothing(n)?Zn:nt(n)?n:Xn(n),u=isNothing(t)?Zn:nt(t)?t:Xn(t);return function(n){return function(t,e,i){var o=0,c=new Map;n(function(n){return c.set(r(n,o++,i.data),u(n,o++,i.data))},function(n){t(c),e(n)},i)}}}function Y(){return function(n){return function(t,r,u){var e=new Set;n(function(n){e.add(n)},function(n){t(e),r(n)},u)}}}function Z(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return On.apply(void 0,[this].concat(t))}function $(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new wt(this.emitter,t)}function nn(n){return new wt(n(this.emitter),this.sources)}function tn(n){return this.chain(k(n))}function rn(n){return this.chain(A(n))}function un(n,t){return this.chain(P(n,t))}function en(n){return this.chain(T(n))}function on(n){return this.chain(N(n))}function cn(n,t){return this.chain(D(n,t))}function an(n){return this.chain(E(n))}function fn(){return this.chain(F())}function ln(){return this.chain(_())}function vn(){return this.chain(B())}function sn(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return On.apply(void 0,t.concat([this]))}function hn(n,t,r){return this.chain(x(n,t,r))}function dn(n,t,r){nt(t)||(t=at),nt(n)||(n=at);var u=new dt(this,r),e=this.emitter;return setImmediate(function(){var r=0;e(function(t){n(t,r++,u)},function(n){u.done(),t(n,r,u)},u)}),this}function wn(n){return this.chain(G(n))}function mn(n){return this.chain(H(n))}function bn(){return this.chain(J())}function pn(n){return this.chain(U(n))}function gn(n){return this.chain(V(n))}function yn(){return this.chain(W())}function xn(){return this.chain(I())}function kn(n,t){return this.chain(X(n,t))}function jn(){return this.chain(Y())}function Sn(n){if(rt(n))return a(n);var t=Vn(n);if(t===Bn)return n.emitter;var r=bt[t];if(nt(r))return r(n);switch(t){case Rn:case Jn:case Un:return a(n);default:var u=n[Hn];return nt(u)?function(n,t,r){for(var e=u();r.active;){var i=e.next();if(i.done)break;n(i.value)}t()}:a(n)}}function An(n,t,r){for(var u=r.flow.sources,e=-1,i=u.length;r.active&&++e<i;)Sn(u[e])(n,at,r);t()}function On(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new wt(An,t)}function Mn(n){return new wt(f(n))}function Pn(n,t){return new wt(l(n,t))}function Tn(n){return new wt(a(n))}function Nn(n,t){return new wt(h(n,t))}function Dn(n,t,r){return new wt(d(n,t,r))}function En(n){return new wt(b(n))}Object.defineProperty(t,"__esModule",{value:!0});var Fn,In,_n=function(){function n(n,t){for(var r=0;r<t.length;r++){var u=t[r];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(n,u.key,u)}}return function(t,r,u){return r&&n(t.prototype,r),u&&n(t,u),t}}(),Bn="Aeroflow",Cn="Array",Rn="Boolean",qn=Symbol.toStringTag,zn="Date",Gn="Function",Hn=Symbol.iterator,Jn="Number",Kn="Promise",Ln="prototype",Qn="RegExp",Un="Symbol",Vn=function(n){return Object.prototype.toString.call(n).slice(8,-1)},Wn=function(n){return function(t){return Vn(t)===n}},Xn=function(n){return function(){return n}},Yn=Date.now,Zn=function(n){return n},$n=Wn(zn),nt=Wn(Gn),tt=Number.isInteger,rt=function(n){return null==n},ut=Wn(Jn),et=Wn(Qn),it=Math.floor,ot=Math.random,ct=Math.max,at=function(){},ft=Object.create,lt=Object.defineProperties,vt=Object.defineProperty,st=Symbol("callbacks"),ht=Symbol("done"),dt=function(){function n(t,r){u(this,n),lt(this,{data:{value:r},flow:{value:t}})}return _n(n,[{key:"done",value:function(){if(this[ht])return!1;vt(this,ht,{value:!0});var n=this[st];return n&&(n.forEach(function(n){return n()}),n.length=0),!0}},{key:"spawn",value:function(){var t=new n(this.flow,this.data);return this.track(function(){return t.done()}),t}},{key:"track",value:function(n){if(nt(n))if(this[ht])n();else{var t=this[st];t?t.push(n):vt(this,st,{value:[n]})}}},{key:"active",get:function(){return!this[ht]}}]),n}(),wt=function pt(n,t){u(this,pt),lt(this,{emitter:{value:n},sources:{value:t}})},mt=ft(null,{count:{value:tn,writable:!0},delay:{value:rn,writable:!0},dump:{value:un,writable:!0},every:{value:en,writable:!0},filter:{value:on,writable:!0},join:{value:cn,writable:!0},map:{value:an,writable:!0},max:{value:fn,writable:!0},mean:{value:ln,writable:!0},min:{value:vn,writable:!0},reduce:{value:hn,writable:!0},skip:{value:wn,writable:!0},some:{value:mn,writable:!0},sum:{value:bn,writable:!0},take:{value:pn,writable:!0},tap:{value:gn,writable:!0},timestamp:{value:yn,writable:!0},toArray:{value:xn,writable:!0},toMap:{value:kn,writable:!0},toSet:{value:jn,writable:!0}});wt[Ln]=ft(mt,(Fn={},r(Fn,qn,{value:Bn}),r(Fn,"append",{value:Z}),r(Fn,"bind",{value:$}),r(Fn,"chain",{value:nn}),r(Fn,"prepend",{value:sn}),r(Fn,"run",{value:dn}),Fn));var bt=ft(null,(In={},r(In,Cn,{value:e,writable:!0}),r(In,Rn,{value:a,writable:!0}),r(In,zn,{value:a,writable:!0}),r(In,Gn,{value:o,writable:!0}),r(In,Jn,{value:a,writable:!0}),r(In,Kn,{value:c,writable:!0}),r(In,Qn,{value:a,writable:!0}),In));lt(On,{adapters:{get:function(){return bt}},create:{value:Mn},empty:{enumerable:!0,value:new wt(i())},expand:{value:Pn},just:{value:Tn},operators:{get:function(){return mt}},random:{value:Nn},range:{value:Dn},repeat:{value:En}}),t["default"]=On,n.exports=t["default"]});