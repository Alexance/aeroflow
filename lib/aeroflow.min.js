"use strict";!function(n,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var e={exports:{}};t(e),n.aeroflow=e.exports}}(this,function(n){function t(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function r(n){var t=!0,e=[],u=function(n){return void 0!==n&&(n===!1?(t=!1,e.forEach(function(n){return n()})):z(n)&&(t?e.push(n):n())),t};return x(u,{data:{value:n},spawn:{value:function(){var t=r(n);return u(t),t}}})}function u(n){return _(n)?function(t,e){return n>e}:z(n)?n:function(){return!0}}function i(n){return z(n)?n:M}function o(n){return R(n)?G:z(n)?n:C(n)?function(t){return n.test(t)}:function(t){return t===n}}function a(n){throw P(n)?n:new Error(n)}function f(n){return O(n)?n:T(n)?s(n):z(n)?d(n):q(n)?w(n):F(n)?h(n):f.just(n)}function c(){for(var n=arguments.length,t=Array(n),e=0;n>e;e++)t[e]=arguments[e];var r=[].concat(t);return new B(function(n,t,e){!function u(){r.length?f(r.shift())[E](n,u,e):t()}()})}function v(n){return z(n)?new B(function(t,e,r){var u=!1;n(function(n){r()&&t()},function(n){u||(u=!0,e(),r(!1))})}):H}function l(n,t,e){e=e||I;var r=z(n)?n:M;return new B(function(n,u,i){for(var o=e,a=0,f=t;0<o--&&i();)n(f=r(f,a++,i.data));u()})}function s(n){return new B(function(t,e,r){for(var u=-1;r()&&++u<n.length;)t(n[u]);e()})}function d(n){return new B(function(t,e,r){return f(n())[E](t,e,r)})}function h(n){return new B(function(t,e,r){for(var u=n[Symbol.iterator]();r();){var i=u.next();if(i.done)break;t(i.value)}e()})}function w(n){return new B(function(t,e,r){return n.then(function(n){return f(n)[E](t,e,r)},function(n){e(n),a(n)})})}function y(n){return new B(function(t,e){t(n),e()})}function m(n,t,e){return e=e||I,n=+n||0,t=+t||1,t-=n,new B(D(n)&&D(t)?function(r,u,i){for(var o=e;0<o--&&i();)r(A(n+t*Math.random()));u()}:function(r,u,i){for(var o=e;0<o--&&i();)r(n+t*Math.random());u()})}function p(n,t,e){return t=+t||I,n=+n||0,e=+e||(t>n?1:-1),n===t?y(n):new B(function(r,u,i){var o=n-e;if(t>n)for(;i()&&(o+=e)<=t;)r(o);else for(;i()&&(o+=e)>=t;)r(o);u()})}function k(n,t){return t=t||I,new B(z(n)?function(e,r,u){function i(n){n?(r(),a(n)):c&&u()?setImmediate(o):r()}function o(){if(0<c--){var t=u()&&n(u.data);t===!1?r():f(t)[E](e,i,u)}else r()}var c=t;o()}:function(e,r,u){for(var i=t;0<i--&&u();)e(n);r()})}var g=function(){function n(n,t){for(var e=0;e<t.length;e++){var r=t[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(n,r.key,r)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}(),b="Aeroflow",E=Symbol("emitter"),j=Object.classof,x=Object.defineProperties,A=Math.floor,S=Date.now,I=Number.MAX_SAFE_INTEGER,M=function(n){return n},O=function(n){return b===j(n)},T=function(n){return"Array"===j(n)},N=function(n){return"Date"===j(n)},P=function(n){return"Error"===j(n)},z=function(n){return"Function"===j(n)},D=Number.isInteger,F=function(n){return Object.isObject(n)&&Symbol.iterator in n},R=function(n){return null==n},_=function(n){return"Number"===j(n)},q=function(n){return"Promise"===j(n)},C=function(n){return"RegExp"===j(n)},G=function(n){return null!=n},X=function(){},B=function(){function n(r){var u;e(this,n),x(this,(u={},t(u,E,{value:r}),t(u,Symbol.toStringTag,{value:b}),u))}return g(n,[{key:"concat",value:function(){for(var n=arguments.length,t=Array(n),e=0;n>e;e++)t[e]=arguments[e];return c.apply(void 0,[this].concat(t))}},{key:"count",value:function(){return this.reduce(function(n){return n+1},0)}},{key:"delay",value:function(t){var e=this,r=z(t)?t:function(){return t};return new n(function(n,t,u){var i=S(),o=0;e[E](function(t){var e=r(t,o++,u.data),a=void 0;N(e)?(a=e,e-=S()):a=S()+e,a>i&&(i=a),0>e?setImmediate(function(){return n(t)}):setTimeout(function(){return n(t)},e)},function(n){i-=S(),0>i?setImmediate(function(){return t(n)}):setTimeout(function(){return t(n)},i)},u)})}},{key:"dump",value:function(t,e){var r=this;return z(t)?(e=t,t=""):(z(e)||(e=console.log.bind(console)),t=R(t)?"":t+" "),new n(function(n,u,i){return r[E](function(r){e(t+"next",r),n(r)},function(n){n?e(t+"done",n):e(t+"done"),u(n)},i)})}},{key:"every",value:function(t){var e=this,r=o(t);return new n(function(n,t,u){var i=!0,o=!0;u=u.spawn(),e[E](function(n){i=!1,r(n)||(o=!1,u(!1))},function(e){n(o&&!i),t(e)},u)})}},{key:"filter",value:function(t){var e=this,r=o(r);return new n(function(n,t,u){var i=0;e[E](function(t){return r(t,i++,u.data)?n(t):!1},t,u)})}},{key:"first",value:function(){var t=this;return new n(function(n,e,r){r=r.spawn(),t[E](function(t){n(t),r(!1)},e,r)})}},{key:"join",value:function(n){var t=R(n)?",":z(n)?n:""+n;return this.reduce(function(n,e){return n.length?n+t()+e:e},"")}},{key:"last",value:function(){var t=this;return new n(function(n,e,r){var u=!0,i=void 0;t[E](function(n){u=!1,i=n},function(t){u||n(i),e(t)},r)})}},{key:"map",value:function(t){var e=this;return t=i(t),new n(function(n,r,u){var i=0;e[E](function(e){return n(t(e,i++,u.data))},r,u)})}},{key:"max",value:function(){return this.reduce(function(n,t){return t>n?t:n})}},{key:"mean",value:function(){var t=this.toArray();return new n(function(n,e,r){return t[E](function(t){t.length&&(t.sort(),n(t[A(t.length/2)]))},e,r)})}},{key:"min",value:function(n){return this.reduce(function(n,t){return n>t?t:n})}},{key:"reduce",value:function(t,e){var r=this;return t=i(t),new n(function(n,u,i){var o=!0,a=0,f=void 0;G(e)&&(o=!1,f=e),r[E](function(n){o?(o=!1,a++,f=n):f=t(f,n,a++,i.data)},function(t){o||n(f),u(t)},i)})}},{key:"run",value:function(n,t,e){var u=this,i=r(e);return z(t)||(t=X),z(n)||(n=X),setImmediate(function(){return u[E](n,function(n){i(!1),n?t(n):t()},i)}),this}},{key:"share",value:function(t){var e=this,r=void 0,u=z(t)?t:_(t)?function(){return t}:function(){return I};return new n(function(n,t,i){return r?(r.forEach(n),void t()):(r=[],void e[E](function(t){r.push(t),n(t)},function(n){setTimeout(function(){r=null},u(i.data)),t(n)},i))})}},{key:"skip",value:function(t){var e=this;if(R(t))return new n(function(n,t,r){return e[E](function(n){},t,r)});var r=u(t);return new n(function(n,t,u){var i=0,o=!0;e[E](function(t){o&&!r(t,i++,u.data)&&(o=!1),o||n(t)},t,u)})}},{key:"some",value:function(t){var e=this;return t=o(t),new n(function(n,r,u){var i=!1;u=u.spawn(),e[E](function(n){t(n)&&(i=!0,u(!1))},function(t){n(i),r(t)},u)})}},{key:"sort",value:function(t){var e=this.toArray();return new n(function(n,r,u){return e[E](function(e){return e.length?e.sort(t).forEach(n):!1},r,u)})}},{key:"sum",value:function(){return this.reduce(function(n,t){return n+t},0)}},{key:"take",value:function(t){var e=this;if(R(t))return this;var r=u(t);return new n(function(n,t,u){var i=0;u=u.spawn(),e[E](function(t){return r(t,i++,u.data)?n(t):u(!1)},t,u)})}},{key:"tap",value:function(t){var e=this;return z(t)?new n(function(n,r,u){var i=0;e[E](function(e){t(e,i++,u.data),n(e)},r,u)}):this}},{key:"timedelta",value:function(){var t=this;return new n(function(n,e,r){var u=S();t[E](function(t){var e=S();n({timedelta:e-u,value:t}),u=e},e,r)})}},{key:"timestamp",value:function(){var t=this;return new n(function(n,e,r){return t[E](function(t){return n({timestamp:S(),value:t})},e,r)})}},{key:"toArray",value:function(t){var e=this;return t=i(t),new n(function(n,r,u){var i=0,o=[];e[E](function(n){return o.push(t(n,i++,u.data))},function(t){n(o),r(t)},u)})}},{key:"toSet",value:function(t){var e=this;return t=i(t),new n(function(n,r,u){var i=0,o=new Set;e[E](function(n){return o.add(t(n,i++,u.data))},function(t){n(o),r(t)},u)})}},{key:"toMap",value:function(t,e){var r=this;return t=z(t)?t:function(n){return T(n)&&2===n.length?n[0]:n},e=z(e)?e:function(n){return T(n)&&2===n.length?n[1]:n},new n(function(n,u,i){var o=0,a=new Map;r[E](function(n){return a.set(t(n,o,i.data),e(n,o++,i.data))},function(t){n(a),u(t)},i)})}},{key:"unique",value:function(){var t=this;return new n(function(n,e,r){var u=new Set;t[E](function(t){var e=u.size;u.add(t),e<u.size&&n(t)},e,r)})}}]),n}(),H=new B(function(n,t){return t()});n.exports=x(f,{concat:{value:c},create:{value:v},empty:{value:H},expand:{value:l},just:{value:y},random:{value:m},range:{value:p},repeat:{value:k}})});