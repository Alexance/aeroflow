"use strict";!function(n,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var r={exports:{}};t(r),n.aeroflow=r.exports}}(this,function(n){function t(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function e(n){var t=!0,r=[],u=function(n){return void 0!==n&&(n===!1?(t=!1,r.forEach(function(n){return n()})):_(n)&&(t?r.push(n):n())),t};return M(u,{data:{value:n},spawn:{value:function(){var t=e(n);return u(t),t}}})}function u(n){return X(n)?function(t,r){return n>r}:_(n)?n:function(){return!0}}function o(n){return _(n)?n:P}function i(n){return G(n)?J:_(n)?n:H(n)?function(t){return n.test(t)}:function(t){return t===n}}function a(n){throw R(n)?n:new Error(n)}function f(n){return z(n)?n:D(n)?s(n):_(n)?h(n):B(n)?y(n):C(n)?d(n):f.just(n)}function c(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];var e=[].concat(t);return new L(function(n,t,r){!function u(){e.length?f(e.shift())[S](n,u,r):t()}()})}function v(n){return _(n)?new L(function(t,r,e){var u=!1;n(function(n){e()&&t()},function(n){u||(u=!0,r(),e(!1))})}):Q}function l(n,t,r){r=r||N;var e=_(n)?n:P;return new L(function(n,u,o){for(var i=r,a=0,f=t;0<i--&&o();)n(f=e(f,a++,o.data));u()})}function s(n){return new L(function(t,r,e){for(var u=-1;e()&&++u<n.length;)t(n[u]);r()})}function h(n){return new L(function(t,r,e){return f(n())[S](t,r,e)})}function d(n){return new L(function(t,r,e){for(var u=n[Symbol.iterator]();e();){var o=u.next();if(o.done)break;t(o.value)}r()})}function y(n){return new L(function(t,r,e){return n.then(function(n){return f(n)[S](t,r,e)},function(n){r(n),a(n)})})}function w(n){return new L(function(t,r){t(n),r()})}function m(n,t,r){return r=r||N,n=+n||0,t=+t||1,t-=n,new L(q(n)&&q(t)?function(e,u,o){for(var i=r;0<i--&&o();)e(O(n+t*Math.random()));u()}:function(e,u,o){for(var i=r;0<i--&&o();)e(n+t*Math.random());u()})}function p(n,t,r){return t=+t||N,n=+n||0,r=+r||(t>n?1:-1),n===t?w(n):new L(function(e,u,o){var i=n-r;if(t>n)for(;o()&&(i+=r)<=t;)e(i);else for(;o()&&(i+=r)>=t;)e(i);u()})}function g(n,t){return t=t||N,new L(_(n)?function(r,e,u){function o(n){n?(e(),a(n)):c&&u()?setImmediate(i):e()}function i(){if(0<c--){var t=u()&&n(u.data);t===!1?e():f(t)[S](r,o,u)}else e()}var c=t;i()}:function(r,e,u){for(var o=t;0<o--&&u();)r(n);e()})}function k(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];switch(r=r.filter(_),r.length){case 0:return E(n);case 1:return b(n,r[0]);default:return A(n,r)}}function b(n,t){var r=n.toArray();return new L(function(n,e,u){return r[S](function(r){return r.length?r.sort(t).forEach(n):!1},e,u)})}function A(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];var u=n.toArray(),o=r.reduce(function(n,t){return function(r,e){var u=n(r,e);return u?u:t(r,e)}});return new L(function(n,t,r){return u[S](function(t){return t.length?t.sort(o).forEach(n):!1},t,r)})}function E(n){var t=n.toArray();return new L(function(n,r,e){return t[S](function(t){return t.length?t.sort().forEach(n):!1},r,e)})}var j=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),x="Aeroflow",S=Symbol("emitter"),I=Object.classof,M=Object.defineProperties,O=Math.floor,T=Date.now,N=Number.MAX_SAFE_INTEGER,P=function(n){return n},z=function(n){return x===I(n)},D=function(n){return"Array"===I(n)},F=function(n){return"Date"===I(n)},R=function(n){return"Error"===I(n)},_=function(n){return"Function"===I(n)},q=Number.isInteger,C=function(n){return Object.isObject(n)&&Symbol.iterator in n},G=function(n){return null==n},X=function(n){return"Number"===I(n)},B=function(n){return"Promise"===I(n)},H=function(n){return"RegExp"===I(n)},J=function(n){return null!=n},K=function(){},L=function(){function n(e){var u;r(this,n),M(this,(u={},t(u,S,{value:e}),t(u,Symbol.toStringTag,{value:x}),u))}return j(n,[{key:"concat",value:function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return c.apply(void 0,[this].concat(t))}},{key:"count",value:function(){return this.reduce(function(n){return n+1},0)}},{key:"delay",value:function(t){var r=this,e=_(t)?t:function(){return t};return new n(function(n,t,u){var o=T(),i=0;r[S](function(t){var r=e(t,i++,u.data),a=void 0;F(r)?(a=r,r-=T()):a=T()+r,a>o&&(o=a),0>r?setImmediate(function(){return n(t)}):setTimeout(function(){return n(t)},r)},function(n){o-=T(),0>o?setImmediate(function(){return t(n)}):setTimeout(function(){return t(n)},o)},u)})}},{key:"dump",value:function(t,r){var e=this;return _(t)?(r=t,t=""):(_(r)||(r=console.log.bind(console)),t=G(t)?"":t+" "),new n(function(n,u,o){return e[S](function(e){r(t+"next",e),n(e)},function(n){n?r(t+"done",n):r(t+"done"),u(n)},o)})}},{key:"every",value:function(t){var r=this,e=i(t);return new n(function(n,t,u){var o=!0,i=!0;u=u.spawn(),r[S](function(n){o=!1,e(n)||(i=!1,u(!1))},function(r){n(i&&!o),t(r)},u)})}},{key:"filter",value:function(t){var r=this,e=i(e);return new n(function(n,t,u){var o=0;r[S](function(t){return e(t,o++,u.data)?n(t):!1},t,u)})}},{key:"first",value:function(){var t=this;return new n(function(n,r,e){e=e.spawn(),t[S](function(t){n(t),e(!1)},r,e)})}},{key:"join",value:function(n){var t=G(n)?",":_(n)?n:""+n;return this.reduce(function(n,r){return n.length?n+t()+r:r},"")}},{key:"last",value:function(){var t=this;return new n(function(n,r,e){var u=!0,o=void 0;t[S](function(n){u=!1,o=n},function(t){u||n(o),r(t)},e)})}},{key:"map",value:function(t){var r=this;return t=o(t),new n(function(n,e,u){var o=0;r[S](function(r){return n(t(r,o++,u.data))},e,u)})}},{key:"max",value:function(){return this.reduce(function(n,t){return t>n?t:n})}},{key:"mean",value:function(){var t=this.toArray();return new n(function(n,r,e){return t[S](function(t){t.length&&(t.sort(),n(t[O(t.length/2)]))},r,e)})}},{key:"min",value:function(n){return this.reduce(function(n,t){return n>t?t:n})}},{key:"reduce",value:function(t,r){var e=this;return t=o(t),new n(function(n,u,o){var i=!0,a=0,f=void 0;J(r)&&(i=!1,f=r),e[S](function(n){i?(i=!1,a++,f=n):f=t(f,n,a++,o.data)},function(t){i||n(f),u(t)},o)})}},{key:"run",value:function(n,t,r){var u=this,o=e(r);return _(t)||(t=K),_(n)||(n=K),setImmediate(function(){return u[S](n,function(n){o(!1),n?t(n):t()},o)}),this}},{key:"share",value:function(t){var r=this,e=void 0,u=_(t)?t:X(t)?function(){return t}:function(){return N};return new n(function(n,t,o){return e?(e.forEach(n),void t()):(e=[],void r[S](function(t){e.push(t),n(t)},function(n){setTimeout(function(){e=null},u(o.data)),t(n)},o))})}},{key:"skip",value:function(t){var r=this;if(G(t))return new n(function(n,t,e){return r[S](function(n){},t,e)});var e=u(t);return new n(function(n,t,u){var o=0,i=!0;r[S](function(t){i&&!e(t,o++,u.data)&&(i=!1),i||n(t)},t,u)})}},{key:"some",value:function(t){var r=this;return t=i(t),new n(function(n,e,u){var o=!1;u=u.spawn(),r[S](function(n){t(n)&&(o=!0,u(!1))},function(t){n(o),e(t)},u)})}},{key:"sort",value:function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return k.apply(void 0,[this].concat(t))}},{key:"sum",value:function(){return this.reduce(function(n,t){return n+t},0)}},{key:"take",value:function(t){var r=this;if(G(t))return this;var e=u(t);return new n(function(n,t,u){var o=0;u=u.spawn(),r[S](function(t){return e(t,o++,u.data)?n(t):u(!1)},t,u)})}},{key:"tap",value:function(t){var r=this;return _(t)?new n(function(n,e,u){var o=0;r[S](function(r){t(r,o++,u.data),n(r)},e,u)}):this}},{key:"timedelta",value:function(){var t=this;return new n(function(n,r,e){var u=T();t[S](function(t){var r=T();n({timedelta:r-u,value:t}),u=r},r,e)})}},{key:"timestamp",value:function(){var t=this;return new n(function(n,r,e){return t[S](function(t){return n({timestamp:T(),value:t})},r,e)})}},{key:"toArray",value:function(t){var r=this;return t=o(t),new n(function(n,e,u){var o=0,i=[];r[S](function(n){return i.push(t(n,o++,u.data))},function(t){n(i),e(t)},u)})}},{key:"toSet",value:function(t){var r=this;return t=o(t),new n(function(n,e,u){var o=0,i=new Set;r[S](function(n){return i.add(t(n,o++,u.data))},function(t){n(i),e(t)},u)})}},{key:"toMap",value:function(t,r){var e=this;return t=_(t)?t:function(n){return D(n)&&2===n.length?n[0]:n},r=_(r)?r:function(n){return D(n)&&2===n.length?n[1]:n},new n(function(n,u,o){var i=0,a=new Map;e[S](function(n){return a.set(t(n,i,o.data),r(n,i++,o.data))},function(t){n(a),u(t)},o)})}},{key:"unique",value:function(){var t=this;return new n(function(n,r,e){var u=new Set;t[S](function(t){var r=u.size;u.add(t),r<u.size&&n(t)},r,e)})}}]),n}(),Q=new L(function(n,t){return t()});n.exports=M(f,{concat:{value:c},create:{value:v},empty:{value:Q},expand:{value:l},just:{value:w},random:{value:m},range:{value:p},repeat:{value:g},sort:{value:k}})});