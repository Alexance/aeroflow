!function(n,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var r={exports:{}};t(r,r.exports),n.aeroflow=r.exports}}(this,function(n,t){"use strict";function r(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function e(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function u(n){return function(t,r,e){for(var u=-1;e.active&&++u<n.length;)t(n[u]);r()}}function i(){return function(n,t){return t()}}function o(n){return function(t,r,e){t(n(e.data)),r()}}function c(n){return function(t,r,e){return n.then(function(n){t(n),r()},function(n){return r(n)})}}function a(n){return function(t,r){t(n),r()}}function f(n){return arguments.length?tt(n)?function(t,r,e){return e.track(n(function(n){e.active&&t()},function(n){e.active&&(r(),e.done())},e))}:a(n):i()}function l(n,t){var r=tt(n)?n:Yn(n);return function(n,e,u){for(var i=0,o=t;u.active;)n(o=r(o,i++,u.data));e()}}function s(n,t){return function(r,e,u){for(;u.active;)r(n+t*it());e()}}function v(n,t){return function(r,e,u){for(;u.active;)r(ut(n+t*it()));e()}}function h(n,t){return n=+n||0,t=+t||1,t-=n,rt(n)&&rt(t)?v(n,t):s(n,t)}function d(n,t,r){return function(e,u,i){var o=n-r;if(t>n)for(;i.active&&(o+=r)<=t;)e(o);else for(;i.active&&(o+=r)>=t;)e(o);u()}}function w(n){return function(t,r,e){for(var u=0,i=void 0;e.active&&!1!==(i=n(u++,e.data));)t(i);r()}}function b(n){return function(t,r,e){for(;e.active;)t(n);r()}}function m(n){return isFunction(n)?w(n):b(n)}function p(n){return function(t){return function(r,e,u){var i=!0,o=1,c=void 0;t(function(t){i?(i=!1,c=t):c=n(c,t,o++,u.data)},function(n){i||r(c),e(n)},u)}}}function g(n,t){return function(r){return function(e,u,i){var o=0,c=t;r(function(t){return c=n(c,t,o++,i.data)},function(n){e(c),u(n)},i)}}}function y(n,t){return function(r){return function(e,u,i){var o=!0,c=0,a=t;r(function(t){o=!1,a=n(a,t,c++,i.data)},function(n){o||e(a),u(n)},i)}}}function k(n,t,r){var e=arguments.length;if(!e||!tt(n))return function(){return i()};switch(e){case 1:return p(n);case 2:return g(n,t);default:return tt(n)?r?y(n,t):g(n,t):function(){return a(n)}}}function x(n){return(n?y:g)(function(n){return n+1},0)}function j(n){return function(t){return function(r,e,u){var i=Zn(),o=0;t(function(t){var e=n(t,o++,u.data),c=void 0;nt(e)?(c=e,e-=Zn()):c=Zn()+e,c>i&&(i=c+1),setTimeout(function(){return r(t)},ot(e,0))},function(n){i-=Zn(),setTimeout(function(){return e(n)},ot(i,0))},u)}}}function S(n){return function(t){return function(r,e,u){return t(function(t){return setTimeout(function(){return r(t)},n)},function(t){return setTimeout(function(){return e(t)},n)},u)}}}function A(n){switch(Wn(n)){case qn:return j(function(){return ot(n-new Date,0)});case zn:return j(n);default:return S(ot(+n||0,0))}}function O(n){return function(t){return function(r,e,u){return t(function(t){console.log(n+"next",t),r(t)},function(t){t?console.error(n+"done",t):console.log(n+"done"),e(t)},u)}}}function M(n,t){return function(r){return function(e,u,i){return r(function(r){t(n+"next",r),e(r)},function(r){r?t(n+"done",r):t(n+"done"),u(r)},i)}}}function P(n,t){return tt(n)?M("",n):tt(t)?M(n,t):O(et(n)?"":n)}function T(n){var t=void 0;switch(Wn(n)){case zn:t=n;break;case Ln:t=function(t){return n.test(t)};break;case Vn:t=function(n){return!!n};break;default:t=function(t){return t===n}}return function(n){return function(r,e,u){var i=!0,o=!0;u=u.spawn(),n(function(n){i=!1,t(n)||(o=!1,u.done())},function(n){r(o&&!i),e(n)},u)}}}function N(n){var t=void 0;switch(Wn(n)){case zn:t=n;break;case Ln:t=function(t){return n.test(t)};break;case Vn:t=function(n){return!!n};break;default:t=function(t){return t===n}}return function(n){return function(r,e,u){var i=0;n(function(n){t(n,i++,u.data)&&r(n)},e,u)}}}function D(n,t){var r=tt(n)?n:Yn(et(n)?",":n);return(t?y:g)(function(n,t,e,u){return n.length?n+r(t,e,u)+t:t},"")}function E(n){if(et(n))return $n;var t=tt(n)?n:Yn(n);return function(n){return function(r,e,u){var i=0;n(function(n){return r(t(n,i++,u.data))},e,u)}}}function F(){return p(function(n,t){return t>n?t:n})}function I(){return function(n){return function(t,r,e){var u=[];n(function(n){return u.push(n)},function(n){t(u),r(n)},e)}}}function _(){return function(n){return function(t,r,e){return I()(n)(function(n){n.length&&(n.sort(),t(n[ut(n.length/2)]))},r,e)}}}function B(){return p(function(n,t){return n>t?t:n})}function C(){return function(n){return function(t,r,e){return n(ct,r,e)}}}function R(n){return function(t){return function(r,e,u){var i=-1;t(function(t){++i>=n&&r(t)},e,u)}}}function U(n){return function(t){return function(r,e,u){return I()(t)(function(t){for(var e=-1,u=t.length-n;++e<u;)r(t[e])},e,u)}}}function q(n){return function(t){return function(r,e,u){var i=0,o=!0;t(function(t){o&&!n(t,i++,u.data)&&(o=!1),o||r(t)},e,u)}}}function z(n){switch(Wn(n)){case Hn:return n>0?R(n):0>n?U(-n):identity;case zn:return q(n);default:return n?C():identity}}function G(n){var t=void 0;switch(Wn(n)){case zn:t=n;break;case Ln:t=function(t){return n.test(t)};break;case Vn:t=function(n){return!!n};break;default:t=function(t){return t===n}}return function(n){return function(r,e,u){var i=!1;u=u.spawn(),n(function(n){t(n)&&(i=!0,u.done())},function(n){r(i),e(n)},u)}}}function H(){return function(n){return g(function(n,t){return n+t},0)}}function J(n){return function(t){return function(r,e,u){var i=1;u=u.spawn(),t(function(t){r(t),n<=i++&&u.done()},e,u)}}}function K(n){return function(t){return function(r,e,u){return I()(t)(function(t){for(var e=t.length,u=ot(e-1-n,0);e>u;)r(t[u++])},e,u)}}}function L(n){return function(t){return function(r,e,u){var i=0;u=u.spawn(),t(function(t){n(t,i++,u.data)?r(t):u.done()},e,u)}}}function Q(n){switch(Wn(n)){case Hn:return n>0?J(n):0>n?K(n):i();case zn:return L(n);default:return n?$n:i()}}function V(n){return function(t){return tt(n)?function(r,e,u){var i=0;t(function(t){return n(t,i++,u.data),r(t)},e,u)}:t}}function W(){return function(n){return function(t,r,e){var u=Zn();n(function(n){var r=Zn();t({timedelta:r-u,timestamp:Zn,value:n}),u=r},r,e)}}}function X(n,t){var r=isNothing(n)?$n:tt(n)?n:Yn(n),e=isNothing(t)?$n:tt(t)?t:Yn(t);return function(n){return function(t,u,i){var o=0,c=new Map;n(function(n){return c.set(r(n,o++,i.data),e(n,o++,i.data))},function(n){t(c),u(n)},i)}}}function Y(){return function(n){return function(t,r,e){var u=new Set;n(function(n){u.add(n)},function(n){t(u),r(n)},e)}}}function Z(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new dt(this.emitter,this.sources.concat(t))}function $(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new dt(this.emitter,t)}function nn(n){return new dt(n(this.emitter),this.sources)}function tn(n){return this.chain(x(n))}function rn(n){return this.chain(A(n))}function en(n,t){return this.chain(P(n,t))}function un(n){return this.chain(T(n))}function on(n){return this.chain(N(n))}function cn(n,t){return this.chain(D(n,t))}function an(n){return this.chain(E(n))}function fn(){return this.chain(F())}function ln(){return this.chain(_())}function sn(){return this.chain(B())}function vn(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new dt(this.emitter,t.concat(this.sources))}function hn(n,t,r){return this.chain(k(n,t,r))}function dn(n,t,r){tt(t)||(t=ct),tt(n)||(n=ct);var e=new ht(this,r),u=this.emitter;return setImmediate(function(){var r=0;u(function(t){n(t,r++,e)},function(n){e.done(),t(n,r,e)},e)}),this}function wn(n){return this.chain(z(n))}function bn(n){return this.chain(G(n))}function mn(){return this.chain(H())}function pn(n){return this.chain(Q(n))}function gn(n){return this.chain(V(n))}function yn(){return this.chain(W())}function kn(){return this.chain(I())}function xn(n,t){return this.chain(X(n,t))}function jn(){return this.chain(Y())}function Sn(n){if(et(n))return a(n);var t=Wn(n);if(t===Bn)return n.emitter;var r=bt[t];if(tt(r))return r(n);switch(t){case Rn:case Hn:case Qn:return a(n);default:var e=n[Gn];return tt(e)?function(n,t,r){for(var u=e();r.active;){var i=u.next();if(i.done)break;n(i.value)}t()}:a(n)}}function An(n,t,r){var e=r.flow.sources,u=e.length,i=-1;!function o(c){!c&&r.active&&++i<u?Sn(e[i])(n,o,r):t(c)}()}function On(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return new dt(An,t)}function Mn(n){return new dt(f(n))}function Pn(n,t){return new dt(l(n,t))}function Tn(n){return new dt(a(n))}function Nn(n,t){return new dt(h(n,t))}function Dn(n,t,r){return new dt(d(n,t,r))}function En(n){return new dt(m(n))}Object.defineProperty(t,"__esModule",{value:!0});var Fn,In,_n=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),Bn="Aeroflow",Cn="Array",Rn="Boolean",Un=Symbol.toStringTag,qn="Date",zn="Function",Gn=Symbol.iterator,Hn="Number",Jn="Promise",Kn="prototype",Ln="RegExp",Qn="Symbol",Vn="Undefined",Wn=function(n){return Object.prototype.toString.call(n).slice(8,-1)},Xn=function(n){return function(t){return Wn(t)===n}},Yn=function(n){return function(){return n}},Zn=Date.now,$n=function(n){return n},nt=Xn(qn),tt=Xn(zn),rt=Number.isInteger,et=function(n){return null==n},ut=Math.floor,it=Math.random,ot=Math.max,ct=function(){},at=Object.create,ft=Object.defineProperties,lt=Object.defineProperty,st=Symbol("callbacks"),vt=Symbol("done"),ht=function(){function n(t,r){e(this,n),ft(this,{data:{value:r},flow:{value:t}})}return _n(n,[{key:"done",value:function(){if(this[vt])return!1;lt(this,vt,{value:!0});var n=this[st];return n&&(n.forEach(function(n){return n()}),n.length=0),!0}},{key:"spawn",value:function(){var t=new n(this.flow,this.data);return this.track(function(){return t.done()}),t}},{key:"track",value:function(n){if(tt(n))if(this[vt])n();else{var t=this[st];t?t.push(n):lt(this,st,{value:[n]})}}},{key:"active",get:function(){return!this[vt]}}]),n}(),dt=function mt(n,t){e(this,mt),ft(this,{emitter:{value:n},sources:{value:t}})},wt=at(null,{count:{value:tn,writable:!0},delay:{value:rn,writable:!0},dump:{value:en,writable:!0},every:{value:un,writable:!0},filter:{value:on,writable:!0},join:{value:cn,writable:!0},map:{value:an,writable:!0},max:{value:fn,writable:!0},mean:{value:ln,writable:!0},min:{value:sn,writable:!0},reduce:{value:hn,writable:!0},skip:{value:wn,writable:!0},some:{value:bn,writable:!0},sum:{value:mn,writable:!0},take:{value:pn,writable:!0},tap:{value:gn,writable:!0},timestamp:{value:yn,writable:!0},toArray:{value:kn,writable:!0},toMap:{value:xn,writable:!0},toSet:{value:jn,writable:!0}});dt[Kn]=at(wt,(Fn={},r(Fn,Un,{value:Bn}),r(Fn,"append",{value:Z}),r(Fn,"bind",{value:$}),r(Fn,"chain",{value:nn}),r(Fn,"prepend",{value:vn}),r(Fn,"run",{value:dn}),Fn));var bt=at(null,(In={},r(In,Cn,{value:u,writable:!0}),r(In,Rn,{value:a,writable:!0}),r(In,qn,{value:a,writable:!0}),r(In,zn,{value:o,writable:!0}),r(In,Hn,{value:a,writable:!0}),r(In,Jn,{value:c,writable:!0}),r(In,Ln,{value:a,writable:!0}),In));ft(On,{adapters:{get:function(){return bt}},create:{value:Mn},empty:{enumerable:!0,value:new dt(i())},expand:{value:Pn},just:{value:Tn},operators:{get:function(){return wt}},random:{value:Nn},range:{value:Dn},repeat:{value:En}}),t["default"]=On,n.exports=t["default"]});