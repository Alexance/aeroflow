"use strict";!function(n,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var r={exports:{}};t(r),n.aeroflow=r.exports}}(this,function(n){function t(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function e(n,t){var r=!0,u=[],i=function(){return r},o=function(){return r&&(r=!1,u.forEach(function(n){return n()})),!1},c=function(n){return mn(n)&&(r?u.push(n):n()),n},f=function(){return c(e(n,t))};return en(i,{data:{value:t},flow:{value:n},end:{value:o},onend:{value:c},spawn:{value:f}})}function u(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];switch(t.length){case 0:return o();case 1:var e=t[0];return ln(e)?e[tn]:hn(e)?i(e):mn(e)?c(e):kn(e)?a(e):gn(e)?f(e):s(e);default:return function(n,r,e){var i=t.length,o=-1;!function c(){++o<i?u(t[o])(n,c,e):r()}()}}}function i(n){return function(t,r,e){for(var u=-1;e()&&++u<n.length;)t(n[u]);r()}}function o(){return function(n,t){return t()}}function c(n){return function(t,r,e){return u(n())(t,r,e)}}function f(n){return function(t,r,e){for(var u=n[Symbol.iterator]();e();){var i=u.next();if(i.done)break;t(i.value)}r()}}function a(n){return function(t,r,e){return n.then(function(n){return u(n)(t,r,e)},function(n){r(n),En(n)})}}function s(n){return function(t,r){t(n),r()}}function l(){return new Sn(u.apply(void 0,arguments))}function h(n){return arguments.length?mn(n)?new Sn(function(t,r,e){var u=!1;e.onend(n(function(n){return e()?t():!1},function(n){u||(u=!0,r(),e.end())},e))}):d(n):An}function v(n,t){return mn(n)?new Sn(function(r,e,u){for(var i=0,o=t;u();)r(o=n(o,i++,u.data));e()}):p(n)}function d(n){return new Sn(s(n))}function m(n,t){n=+n||0,t=+t||1,t-=n;var r=wn(n)&&wn(t)?function(){return un(n+t*Math.random())}:function(){return n+t*Math.random()};return new Sn(function(n,t,e){for(;e();)n(r());t()})}function w(n,t,r){return t=+t||on,n=+n||0,r=+r||(t>n?1:-1),n===t?d(n):new Sn(function(e,u,i){var o=n-r;if(t>n)for(;i()&&(o+=r)<=t;)e(o);else for(;i()&&(o+=r)>=t;)e(o);u()})}function g(n){return mn(n)?y(n):p(n)}function y(n){return new Sn(function(t,r,e){function i(n){n?(r(),En(n)):e()?setImmediate(o):r()}function o(){var o=e()&&n(c,e.data);o===!1?r():u(o)(t,i,e)}var c=0;o()})}function p(n){return function(t,r,e){for(;e();)t(n);r()}}function k(n,t){return new Sn(function(r,e,u){return n[tn](function(n){return setTimeout(function(){return r(n)},Math.max(t,0))},function(n){return setTimeout(function(){return e(n)},Math.max(t,0))},u)})}function b(n,t){return new Sn(function(r,e,u){var i=cn(),o=0;n[tn](function(n){var e=t(n,o++,u.data),c=void 0;vn(e)?(c=e,e-=cn()):c=cn()+e,c>i&&(i=c),0>e?setImmediate(function(){return r(n)}):setTimeout(function(){return r(n)},e)},function(n){i-=cn(),0>i?setImmediate(function(){return e(n)}):setTimeout(function(){return e(n)},i)},u)})}function x(n,t,r){return new Sn(function(e,u,i){return n[tn](function(n){r(t+"next",n),e(n)},function(n){n?r(t+"done",n):r(t+"done"),u(n)},i)})}function E(n,t){return new Sn(function(r,e,u){return n[tn](function(n){console.log(t+"next",n),r(n)},function(n){n?console.error(t+"done",n):console.log(t+"done"),e(n)},u)})}function A(n){var t=this;return new Sn(function(r,e,u){var i=!0,o=!0;u=u.spawn(),t[tn](function(t){i=!1,n(t)&&(o=!1,u.end())},function(n){r(o&&!i),e(n)},u)})}function S(n,t){return new Sn(function(r,e,u){var i=0;n[tn](function(n){return t(n,i++,u.data)?r(n):!1},e,u)})}function M(n,t){return O(n,function(n,r,e,u){return n.length?n+t(r,e,u)+r:r},"")}function j(n,t){return new Sn(function(r,e,u){var i=0;n[tn](function(n){return r(t(n,i++,u.data))},e,u)})}function T(n,t,r){return new Sn(function(e,u,i){var o=0,c=r;n[tn](function(n){return c=t(c,n,o++,i.data)},function(n){e(c),u(n)},i)})}function I(n,t){return new Sn(function(r,e,u){var i=!0,o=0,c=void 0;n[tn](function(n){An?(i=!1,o++,c=n):c=t(c,n,o++,u.data)},function(n){i||r(c),e(n)},u)})}function O(n,t,r){return new Sn(function(e,u,i){var o=!0,c=0,f=r;n[tn](function(n){o=!1,f=t(f,n,c++,i.data)},function(n){o||e(f),u(n)},i)})}function N(n,t,r,e){n[tn](function(n){return t(n,e)},function(n){e.end(),r(n,e)},e)}function P(n){var t=[],r=!1;return new Sn(function(e,u,i){r?(t.forEach(e),u()):n[tn](function(n){t.push(n),e(n)},function(n){r=!0,u(n)},i)})}function D(n,t){var r=[],e=!1;return new Sn(function(u,i,o){e?(r.forEach(u),i()):n[tn](function(n){r.push(n),u(n)},function(n){setTimeout(function(){r=[],e=!1},t(o.data)),i(n)},o)})}function z(n){return new Sn(function(t,r,e){return n[tn](xn,r,e)})}function F(n,t){return new Sn(function(r,e,u){var i=-1;n[tn](function(n){return++i<t?!1:r(n)},e,u)})}function R(n,t){var r=Q(n);return new Sn(function(n,e,u){return r[tn](function(r){for(var e=0,u=r.length-t;u>e;e++)n(r[e])},e,u)})}function _(n,t){return new Sn(function(r,e,u){var i=0,o=!0;n[tn](function(n){o&&!t(n,i++,u.data)&&(o=!1),o||r(n)},e,u)})}function q(n,t){return new Sn(function(r,e,u){var i=!1;u=u.spawn(),n[tn](function(n){t(n)&&(i=!0,u.end())},function(n){r(i),e(n)},u)})}function C(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];switch(mn(t)&&(e.unshift(t),t=1),e.every(mn)||En("Selector function expected."),t){case"asc":case 1:case void 0:case null:t=1;break;case"desc":case-1:t=-1;break;default:t=t?1:-1}switch(e.length){case 0:return G(n,t);case 1:return X(n,t,e[0]);default:return B.apply(void 0,[n,t].concat(e))}}function G(n,t){var r=Q(n);return new Sn(function(n,e,u){return r[tn](function(r){return 1===t?r.sort().forEach(n):r.sort().reverse().forEach(n)},e,u)})}function X(n,t,r){var e=Q(n),u=function(n,e){return t*fn(r(n),r(e))};return new Sn(function(n,t,r){return e[tn](function(t){return t.sort(u).forEach(n)},t,r)})}function B(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];var i=Q(n),o=e.length,c=function(n,r){for(var u=-1;++u<o;){var i=e[u],c=t*fn(i(n),i(r));if(c)return c}return 0};return new Sn(function(n,t,r){return i[tn](function(t){return t.sort(c).forEach(n)},t,r)})}function H(n,t){return new Sn(function(r,e,u){var i=1;u=u.spawn(),n[tn](function(n){r(n),t<=i++&&u.end()},e,u)})}function J(n,t){var r=Q(n);return new Sn(function(n,e,u){r[tn](function(r){for(var e=r.length,u=Math.max(length-1-t,0);e>u;)n(r[u++])},e,u)})}function K(n,t){return new Sn(function(r,e,u){var i=0;u=u.spawn(),n[tn](function(n){return t(n,i++,u.data)?r(n):u.end()},e,u)})}function L(n,t){return new Sn(function(r,e,u){var i=0;n[tn](function(n){t(n,i++,u.data),r(n)},e,u)})}function Q(n){return new Sn(function(t,r,e){var u=[];n[tn](function(n){return u.push(n)},function(n){t(u),r(n)},e)})}function U(n,t){return new Sn(function(r,e,u){var i=0,o=[];n[tn](function(n){return o.push(t(n,i++,u.data))},function(n){r(o),e(n)},u)})}function V(n){return new Sn(function(t,r,e){var u=new Map;n[tn](function(n){return u.set(n,n)},function(n){t(u),r(n)},e)})}function W(n,t,r){return new Sn(function(e,u,i){var o=0,c=new Map;n[tn](function(n){return c.set(t(n,o++,i.data),r(n,o++,i.data))},function(n){e(c),u(n)},i)})}function Y(n){return new Sn(function(t,r,e){var u=new Set;n[tn](function(n){return u.add(n)},function(n){t(u),r(n)},e)})}function Z(n,t){return new Sn(function(r,e,u){var i=0,o=new Set;n[tn](function(n){return o.add(t(n,i++,u.data))},function(n){r(o),e(n)},u)})}var $=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),nn="Aeroflow",tn=Symbol("emitter"),rn=Object.classof,en=Object.defineProperties,un=Math.floor,on=Number.MAX_SAFE_INTEGER,cn=Date.now,fn=function(n,t){return t>n?-1:n>t?1:0},an=function(n){return function(){return n}},sn=function(n){return n},ln=function(n){return nn===rn(n)},hn=function(n){return"Array"===rn(n)},vn=function(n){return"Date"===rn(n)},dn=function(n){return"Error"===rn(n)},mn=function(n){return"Function"===rn(n)},wn=Number.isInteger,gn=function(n){return Object.isObject(n)&&Symbol.iterator in n},yn=function(n){return null==n},pn=function(n){return"Number"===rn(n)},kn=function(n){return"Promise"===rn(n)},bn=function(n){return"RegExp"===rn(n)},xn=function(){},En=function(n){throw dn(n)?n:new Error(n)},An=void 0,Sn=function(){function n(e){var u;r(this,n),en(this,(u={},t(u,tn,{value:e}),t(u,Symbol.toStringTag,{value:nn}),u))}return $(n,[{key:"append",value:function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return l.apply(void 0,[this].concat(t))}},{key:"count",value:function(){return T(this,function(n){return n+1},0)}},{key:"delay",value:function(n){return mn(n)?b(this,n):vn(n)?b(this,function(){return n-new Date}):k(this,+n||0)}},{key:"dump",value:function(n,t){switch(arguments.length){case 0:return E(this,"");case 1:return mn(n)?x(this,"",n):E(this,"");default:return mn(t)?yn(n)?x(this,"",t):x(this,n,t):E(this,n)}}},{key:"every",value:function(n){return A(this,yn(n)?function(n){return!!n}:mn(n)?n:bn(n)?function(t){return n.test(t)}:function(t){return t===n})}},{key:"filter",value:function(n){return S(this,yn(n)?function(n){return!!n}:mn(n)?n:bn(n)?function(t){return n.test(t)}:function(t){return t===n})}},{key:"join",value:function(n){return M(this,arguments.length?mn(n)?n:function(){return""+n}:function(){return","})}},{key:"map",value:function(n){return arguments.length?j(this,mn(n)?n:function(){return n}):this}},{key:"max",value:function(){return I(this,function(n,t){return t>n?t:n})}},{key:"mean",value:function(){var t=Q(this);return new n(function(n,r,e){return t[tn](function(t){t.length&&(t.sort(),n(t[un(t.length/2)]))},r,e)})}},{key:"min",value:function(){return I(this,function(n,t){return n>t?t:n})}},{key:"prepend",value:function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return l.apply(void 0,t.concat([this]))}},{key:"reduce",value:function(n,t){switch(arguments.length){case 0:return An;case 1:return mn(n)?I(this,n):d(n);default:return mn(n)?T(this,n,t):d(n)}}},{key:"run",value:function(n,t,r){var u=this;return setImmediate(function(){return N(u,mn(n)?n:xn,mn(t)?t:xn,e(u,r))}),this}},{key:"share",value:function(n){return arguments.length?mn(n)?D(this,n):pn(n)?0>=n?this:D(this,function(){return n}):n?P(this):this:P(this)}},{key:"skip",value:function(n){return arguments.length?pn(n)?0===n?this:n>0?F(this,n):R(this,n):mn(n)?_(this,n):n?z(this):this:z(this)}},{key:"some",value:function(n){return q(this,arguments.length?mn(n)?n:bn(n)?function(t){return n.test(t)}:function(t){return t===n}:function(n){return!!n})}},{key:"sort",value:function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];return C.apply(void 0,[this,n].concat(r))}},{key:"sum",value:function(){return T(this,function(n,t){return n+t},0)}},{key:"take",value:function(n){return arguments.length?pn(n)?0===n?An:n>0?H(this,n):J(this,n):mn(n)?K(this,n):n?this:An:this}},{key:"tap",value:function(n){return mn(n)?L(this,n):this}},{key:"timedelta",value:function(){var t=this;return new n(function(n,r,e){var u=cn();t[tn](function(t){var r=cn();n({timedelta:r-u,value:t}),u=r},r,e)})}},{key:"timestamp",value:function(){var t=this;return new n(function(n,r,e){return t[tn](function(t){return n({timestamp:cn(),value:t})},r,e)})}},{key:"toArray",value:function(n){return arguments.length?mn(n)?U(this,n):U(this,an(n)):Q(this)}},{key:"toMap",value:function(n,t){switch(arguments.length){case 0:return V(this);case 1:return W(this,mn(n)?n:an(n),sn);default:return W(this,mn(n)?n:an(n),mn(t)?n:an(t))}}},{key:"toSet",value:function(n){return arguments.length?mn(n)?Z(this,n):Z(this,an(n)):Y(this)}},{key:"unique",value:function(){var t=this;return new n(function(n,r,e){var u=new Set;t[tn](function(t){var r=u.size;u.add(t),r<u.size&&n(t)},r,e)})}}]),n}();An=new Sn(o()),n.exports=en(l,{create:{value:h},empty:{value:An},expand:{value:v},just:{value:d},random:{value:m},range:{value:w},repeat:{value:g}})});