"use strict";!function(n,t){if("function"==typeof define&&define.amd)define(["module"],t);else if("undefined"!=typeof exports)t(module);else{var r={exports:{}};t(r),n.aeroflow=r.exports}}(this,function(n){function t(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}function r(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function e(){return new U(i.apply(void 0,arguments))}function u(n,t){return t>n?-1:n>t?1:0}function o(n,t){return new U(C(n)?function(r,e,u){var o=!1;n(function(n){return u()?r():!1},function(n){o||(o=!0,e(),u.stop(),C(t)&&t())},u)}:c())}function i(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];switch(t.length){case 0:return c();case 1:var e=t[0];return F(e)?e[M]:R(e)?a(e):C(e)?f(e):J(e)?s(e):X(e)?v(e):l(e);default:return function(n,r,e){var u=t.length,o=-1;!function a(){++o<u?i(t[o])(n,a,e):r()}()}}}function a(n){return function(t,r,e){for(var u=-1;e()&&++u<n.length;)t(n[u]);r()}}function c(){return function(n,t){return t()}}function f(n){return function(t,r,e){return i(n())(t,r,e)}}function v(n){return function(t,r,e){for(var u=n[Symbol.iterator]();e();){var o=u.next();if(o.done)break;t(o.value)}r()}}function s(n){return function(t,r,e){return n.then(function(n){return i(n)(t,r,e)},function(n){r(n),S(n)})}}function l(n){return function(t,r){t(n),r()}}function h(n,t,r){r=r||z;var e=C(n)?n:D;return new U(C(n)?function(n,u,o){for(var i=r,a=0,c=t;0<i--&&o();)n(c=e(c,a++,o.data));u()}:function(n,e,u){for(var o=r;0<o--&&u();)n(t);e()})}function d(n){return new U(l(n))}function m(n,t){var r=!0,e=[],u=function(n){return C(n)&&(r?e.push(n):n()),n},o=function(){return r},i=function(){return u(m(n,t))},a=function(){return r&&(r=!1,e.forEach(function(n){return n()})),!1};return T(o,{care:{value:u},data:{value:t},flow:{value:n},make:{value:i},stop:{value:a}})}function y(n){return C(n)?n:D}function w(n){return B(n)?L:C(n)?n:K(n)?function(t){return n.test(t)}:function(t){return t===n}}function p(n,t,r){return r=r||z,n=+n||0,t=+t||1,t-=n,new U(G(n)&&G(t)?function(e,u,o){for(var i=r;0<i--&&o();)e(N(n+t*Math.random()));u()}:function(e,u,o){for(var i=r;0<i--&&o();)e(n+t*Math.random());u()})}function k(n,t,r){return t=+t||z,n=+n||0,r=+r||(t>n?1:-1),new U(n===t?l(n):function(e,u,o){var i=n-r;if(t>n)for(;o()&&(i+=r)<=t;)e(i);else for(;o()&&(i+=r)>=t;)e(i);u()})}function g(n,t){return t=t||z,new U(C(n)?function(r,e,u){function o(n){n?(e(),S(n)):c&&u()?setImmediate(a):e()}function a(){if(0<c--){var t=u()&&n(u.data);t===!1?e():i(t)(r,o,u)}else e()}var c=t;a()}:function(r,e,u){for(var o=t;0<o--&&u();)r(n);e()})}function b(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),u=2;r>u;u++)e[u-2]=arguments[u];switch(C(t)&&(e.unshift(t),t=1),e.every(C)||S("Selector function expected."),t){case"asc":case 1:case void 0:case null:t=1;break;case"desc":case-1:t=-1;break;default:t=t?1:-1}switch(e.length){case 0:return x(n,t);case 1:return A(n,t,e[0]);default:return E.apply(void 0,[n,t].concat(e))}}function A(n,t,r){var e=n.toArray(),o=function(n,e){return t*u(r(n),r(e))};return new U(function(n,t,r){return e[M](function(t){return t.sort(o).forEach(n)},t,r)})}function E(n,t){for(var r=arguments.length,e=Array(r>2?r-2:0),o=2;r>o;o++)e[o-2]=arguments[o];var i=n.toArray(),a=e.length,c=function(n,r){for(var o=-1;++o<a;){var i=e[o],c=t*u(i(n),i(r));if(c)return c}return 0};return new U(function(n,t,r){return i[M](function(t){return t.sort(c).forEach(n)},t,r)})}function x(n,t){var r=n.toArray();return new U(function(n,e,u){return r[M](function(r){return 1===t?r.sort().forEach(n):r.sort().reverse().forEach(n)},e,u)})}function S(n){throw q(n)?n:new Error(n)}var j=function(){function n(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(t,r,e){return r&&n(t.prototype,r),e&&n(t,e),t}}(),I="Aeroflow",M=Symbol("emitter"),O=Object.classof,T=Object.defineProperties,N=Math.floor,P=Date.now,z=Number.MAX_SAFE_INTEGER,D=function(n){return n},F=function(n){return I===O(n)},R=function(n){return"Array"===O(n)},_=function(n){return"Date"===O(n)},q=function(n){return"Error"===O(n)},C=function(n){return"Function"===O(n)},G=Number.isInteger,X=function(n){return Object.isObject(n)&&Symbol.iterator in n},B=function(n){return null==n},H=function(n){return"Number"===O(n)},J=function(n){return"Promise"===O(n)},K=function(n){return"RegExp"===O(n)},L=function(n){return null!=n},Q=function(){},U=function(){function n(e){var u;r(this,n),T(this,(u={},t(u,M,{value:e}),t(u,Symbol.toStringTag,{value:I}),u))}return j(n,[{key:"concat",value:function(){for(var n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];return e.apply(void 0,[this].concat(t))}},{key:"count",value:function(){return this.reduce(function(n){return n+1},0)}},{key:"delay",value:function(t){var r=this,e=C(t)?t:function(){return t};return new n(function(n,t,u){var o=P(),i=0;r[M](function(t){var r=e(t,i++,u.data),a=void 0;_(r)?(a=r,r-=P()):a=P()+r,a>o&&(o=a),0>r?setImmediate(function(){return n(t)}):setTimeout(function(){return n(t)},r)},function(n){o-=P(),0>o?setImmediate(function(){return t(n)}):setTimeout(function(){return t(n)},o)},u)})}},{key:"dump",value:function(t,r){var e=this;return C(t)?(r=t,t=""):(C(r)||(r=console.log.bind(console)),t=B(t)?"":t+" "),new n(function(n,u,o){return e[M](function(e){r(t+"next",e),n(e)},function(n){n?r(t+"done",n):r(t+"done"),u(n)},o)})}},{key:"every",value:function(t){var r=this,e=w(t);return new n(function(n,t,u){var o=!0,i=!0;u=u.make(),r[M](function(n){o=!1,e(n)||(i=!1,u.stop())},function(r){n(i&&!o),t(r)},u)})}},{key:"filter",value:function(t){var r=this,e=w(e);return new n(function(n,t,u){var o=0;r[M](function(t){return e(t,o++,u.data)?n(t):!1},t,u)})}},{key:"first",value:function(){var t=this;return new n(function(n,r,e){e=e.make(),t[M](function(t){n(t),e.stop()},r,e)})}},{key:"join",value:function(n){var t=B(n)?",":C(n)?n:""+n;return this.reduce(function(n,r){return n.length?n+t()+r:r},"")}},{key:"last",value:function(){var t=this;return new n(function(n,r,e){var u=!0,o=void 0;t[M](function(n){u=!1,o=n},function(t){u||n(o),r(t)},e)})}},{key:"map",value:function(t){var r=this;return t=y(t),new n(function(n,e,u){var o=0;r[M](function(r){return n(t(r,o++,u.data))},e,u)})}},{key:"max",value:function(){return this.reduce(function(n,t){return t>n?t:n})}},{key:"mean",value:function(){var t=this.toArray();return new n(function(n,r,e){return t[M](function(t){t.length&&(t.sort(),n(t[N(t.length/2)]))},r,e)})}},{key:"min",value:function(n){return this.reduce(function(n,t){return n>t?t:n})}},{key:"reduce",value:function(t,r){var e=this;return t=y(t),new n(function(n,u,o){var i=!0,a=0,c=void 0;L(r)&&(i=!1,c=r),e[M](function(n){i?(i=!1,a++,c=n):c=t(c,n,a++,o.data)},function(t){i||n(c),u(t)},o)})}},{key:"run",value:function(n,t,r){var e=this,u=m(this,r);return C(t)||(t=Q),C(n)||(n=Q),setImmediate(function(){return e[M](function(t){return n(t,u)},function(n){u.stop(),t(n,u)},u)}),this}},{key:"share",value:function(t){var r=this,e=void 0,u=C(t)?t:H(t)?function(){return t}:function(){return z};return new n(function(n,t,o){return e?(e.forEach(n),void t()):(e=[],void r[M](function(t){e.push(t),n(t)},function(n){setTimeout(function(){e=null},u(o.data)),t(n)},o))})}},{key:"skip",value:function(t){var r=this;return new n(B(t)?c():H(t)?function(n,e,u){var o=1;r[M](function(r){return t<o++?n(r):!1},e,u)}:C(t)?function(n,e,u){var o=0,i=!0;r[M](function(r){i&&!t(r,o++,u.data)&&(i=!1),i||n(r)},e,u)}:t?c():this[M])}},{key:"some",value:function(t){var r=this;return t=w(t),new n(function(n,e,u){var o=!1;u=u.make(),r[M](function(n){t(n)&&(o=!0,u.stop())},function(t){n(o),e(t)},u)})}},{key:"sort",value:function(n){for(var t=arguments.length,r=Array(t>1?t-1:0),e=1;t>e;e++)r[e-1]=arguments[e];return b.apply(void 0,[this,n].concat(r))}},{key:"sum",value:function(){return this.reduce(function(n,t){return n+t},0)}},{key:"take",value:function(t){var r=this;return new n(H(t)?t>0?function(n,e,u){var o=1;u=u.make(),r[M](function(r){n(r),t<=o++&&u.stop()},e,u)}:c():C(t)?function(n,e,u){var o=0;u=u.make(),r[M](function(r){return t(r,o++,u.data)?n(r):u.stop()},e,u)}:B(t)||t?this[M]:c())}},{key:"tap",value:function(t){var r=this;return C(t)?new n(function(n,e,u){var o=0;r[M](function(r){t(r,o++,u.data),n(r)},e,u)}):this}},{key:"timedelta",value:function(){var t=this;return new n(function(n,r,e){var u=P();t[M](function(t){var r=P();n({timedelta:r-u,value:t}),u=r},r,e)})}},{key:"timestamp",value:function(){var t=this;return new n(function(n,r,e){return t[M](function(t){return n({timestamp:P(),value:t})},r,e)})}},{key:"toArray",value:function(t){var r=this;return t=y(t),new n(function(n,e,u){var o=0,i=[];r[M](function(n){return i.push(t(n,o++,u.data))},function(t){n(i),e(t)},u)})}},{key:"toSet",value:function(t){var r=this;return t=y(t),new n(function(n,e,u){var o=0,i=new Set;r[M](function(n){return i.add(t(n,o++,u.data))},function(t){n(i),e(t)},u)})}},{key:"toMap",value:function(t,r){var e=this;return t=C(t)?t:function(n){return R(n)&&2===n.length?n[0]:n},r=C(r)?r:function(n){return R(n)&&2===n.length?n[1]:n},new n(function(n,u,o){var i=0,a=new Map;e[M](function(n){return a.set(t(n,i,o.data),r(n,i++,o.data))},function(t){n(a),u(t)},o)})}},{key:"unique",value:function(){var t=this;return new n(function(n,r,e){var u=new Set;t[M](function(t){var r=u.size;u.add(t),r<u.size&&n(t)},r,e)})}}]),n}();n.exports=T(e,{create:{value:o},empty:{value:new U(c())},expand:{value:h},just:{value:d},random:{value:p},range:{value:k},repeat:{value:g}})});